<!DOCTYPE html>

<html>
	<head>
		<title>Test 4 of Boris Dimitrov 82066</title>
		<meta charset="utf-8">
		
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		
		<script src="three.min.js"></script>
		<script src="OrbitControls.js"></script>
		<script src="vax.js"></script>
	</head>
	
	<body>
		<script>
			vaxInit();
			
			camera.fov = 30;
			onWindowResize();
				
			scene.background = new THREE.CubeTextureLoader().load( [
				'cube/posx.jpg', 'cube/negx.jpg',
				'cube/posy.jpg', 'cube/negy.jpg',
				'cube/posz.jpg', 'cube/negz.jpg' ] );
				

			var geometry = new THREE.BoxGeometry( 20, 15, 10 ),
				material = new THREE.MeshBasicMaterial( {
								envMap: scene.background,
								reflectivity: 1
							}),
			box = new THREE.Mesh( geometry, material );
			box.position.set(0, 0, -100);
				
			scene.add( box );
			
			function animate()
			{
			}

			var gammaPrev = null;
			var gammaTurns = 0;

			window.addEventListener( "deviceorientation", deviceOrientation, true);
			function deviceOrientation( event )
			{
				var beta = event.beta;
				var gamma = event.gamma;

				if (beta > 90) {
					beta = 180 - beta;
				}
				else if (beta < -90) {
					beta = -180 - beta;
				}

				if (gammaPrev !== null && Math.abs(gamma - gammaPrev) > 180 / 2) {
					if (gammaPrev < 0) {
						gammaTurns--;
					}
					else {
						gammaTurns++;
					}
				}
				gammaPrev = gamma;
				gamma += gammaTurns * 180;

				beta = THREE.MathUtils.degToRad( beta );
				gamma = THREE.MathUtils.degToRad( gamma );
				camera.rotation.set(beta, gamma, 0, 'YXZ');
			}
			
		</script>
		
	</body>
</html>


